<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Satchel</title>
    <style>
      html,
      body {
        margin: 0;
      }

      body {
        display: flex;
        flex-direction: column;
        width: 100vw;
        height: 100vh;
        background-image: url('res/images/wood.jpg');
        background-size: 30rem;
        background-repeat: repeat;
        background-color: #211b1c;
        color: #ffffff;
        overflow: hidden;
        font-family: Georgia, 'Times New Roman', Times, serif;
        box-shadow: inset 0 0 16rem #000000;
      }

      .foreground {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
        overflow: hidden;
        z-index: 5;
      }

      /** To prevent FOUC */
      dialog-prompt:not([open]) {
        display: none;
      }
    </style>
  </head>
  <body>
    <style>
      .body {
        display: flex;
        flex-direction: column;
        width: 100%;
        height: 100%;
      }
    </style>
    <sidebar-layout style="flex-direction: row-reverse">
      <style>
        .groundContainer {
          display: flex;
          flex-direction: column;
        }
        #ground {
          flex: 1;
          display: flex;
          flex-direction: column;
          overflow-y: auto;
          width: 4em;
        }
        #ground > * {
          margin: 0 0.5em;
          margin-top: 0.2em;
        }
        .sidebarActions {
          padding: 0.5em 0;
        }
      </style>
      <div slot="sidebar" class="groundContainer">
        <div class="sidebarActions">
          <icon-button id="actionAlbumOpen" icon="res/bookmarks.svg" alt="album" title="Open Album"></icon-button>
        </div>
        <div id="ground">
          <!-- To be filled with ground items -->
          <album-ground></album-ground>
        </div>
        <div class="sidebarActions">
          <icon-button id="actionNewItem" icon="res/add.svg" alt="new" title="New Item"></icon-button>
        </div>
      </div>
      <div class="body">
        <style>
          main {
            flex: 1;
            overflow: hidden;
          }
          header,
          footer {
            z-index: 1;
          }
        </style>
        <header>
          <style>
            header {
              display: flex;
              flex-direction: row;
              align-items: center;
              padding: 0 2em;
            }
            .spacer {
              flex: 1;
            }
            .toolbar {
              white-space: nowrap;
              overflow-x: auto;
            }
          </style>
          <icon-button id="editButton" icon="res/edit.svg" alt="foundry" title="Open Foundry"></icon-button>
          <div class="spacer"></div>
          <h1>Satchel</h1>
          <small id="onlineStatus"></small>
          <small id="appVersion">v-.-.-</small>
          <div class="spacer"></div>
          <div class="toolbar">
            <style>
              .toolbar button:disabled {
                opacity: 0.3;
              }
              #onlineStatus {
                color: red;
              }
              #onlineStatus::after {
                content: 'OFFLINE';
              }
              #onlineStatus.active {
                color: green;
              }
              #onlineStatus.active::after {
                content: 'ONLINE';
              }
            </style>
            <icon-button id="uploadButton" icon="res/upload.svg" alt="upload" title="Upload"></icon-button>
            <icon-button id="downloadButton" icon="res/download.svg" alt="download" title="Download"></icon-button>
            <icon-button id="cloudButton" icon="res/cloud.svg" alt="connect" title="Connect" disabled></icon-button>
          </div>
        </header>
        <main>
          <style>
            main {
              position: relative;
              display: flex;
              flex-direction: column;
              align-items: center;
              text-align: center;
            }
          </style>
          <style>
            #workspace {
              flex: 1;
              width: 100%;
              height: 100%;
              overflow: auto;
            }
          </style>
          <div id="workspace">
            <inventory-grid invid="main"></inventory-grid>
          </div>
          <item-delete></item-delete>
          <style>
            .sidebar {
              background: #333333;
              position: absolute;
              display: flex;
              flex-direction: row;
              top: 0;
              right: 0;
              left: 0;
              bottom: 0;
              width: 100%;
              height: 100%;
              transform: translateX(-100%);
              transition: transform 0.3s ease;
              --peek-width: 22em;
            }
            .sidebar.open {
              transform: translateX(calc(-100% + var(--peek-width)));
            }
            .sidebar.expand {
              transform: translateX(0%);
            }
            .sidebar .peek {
              width: var(--peek-width);
            }
            .sidebar:not(.open) .peek {
              display: none;
            }
            .sidebar:not(.expand) .peek {
              margin-left: auto;
            }

            .peek {
              display: flex;
              flex-direction: column;
            }
            .peek item-editor {
              flex: 1;
            }
          </style>
          <div class="sidebar">
            <div class="peek">
              <item-editor id="editor"></item-editor>
              <fieldset style="display: flex; flex-direction: column;">
                <button id="actionSendToPlayer">Send To Player</button>
                <button id="actionDropToGround">Drop To Ground</button>
                <button id="actionExportToFile">Export To File</button>
                <button id="actionSaveToAlbum">Save To Album</button>
              </fieldset>
            </div>
          </div>
        </main>
        <footer>
          <style>
            footer {
              font-family: monospace;
              opacity: 0.6;
            }
          </style>
          <a href="https://github.com/andykuo1/satchel" target="_blank">
            <small> Made with ‚ù§ by Andrew Kuo. </small>
          </a>
        </footer>
      </div>
      <style>
        .albumContainer {
          display: flex;
          flex-direction: column;
          position: absolute;
          right: 0;
          top: 0;
          bottom: 0;
          background-color: #333333;
          padding: 0.5em;
          z-index: 1;
          transform: translateX(100%);
          transition: transform 0.2s ease;
        }
        .albumContainer.open {
          transform: translateX(0);
        }
        .albumContainer > * {
          visibility: hidden;
        }
        .albumContainer.open > * {
          visibility: visible;
        }
        .albumActions {
          display: flex;
          flex-direction: column;
        }
        #albumList {
          flex: 1;
          overflow-y: auto;
        }
      </style>
      <div class="albumContainer">
        <div id="albumList"></div>
        <div class="albumActions">
          <button id="actionAlbumNew">New Album</button>
          <button id="actionAlbumImport">Import Album</button>
        </div>
      </div>
    </sidebar-layout>
    <!-- OUTER CONTENT -->
    <div class="foreground">
      <inventory-cursor id="cursor"></inventory-cursor>
    </div>
    <item-detail-editor id="detailEditor"></item-detail-editor>
    <dialog-prompt id="giftDialog">
      <h3>Send item to...</h3>
      <p>
        <select id="giftTarget"></select>
      </p>
      <p>
        <button id="giftSubmit">Send</button>
      </p>
    </dialog-prompt>
    <script type="module" src="src/main.js"></script>
  </body>
</html>
